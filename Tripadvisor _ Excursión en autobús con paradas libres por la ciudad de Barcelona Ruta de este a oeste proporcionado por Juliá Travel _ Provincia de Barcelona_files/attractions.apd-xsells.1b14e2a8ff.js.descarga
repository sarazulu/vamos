($WP="undefined"!=typeof $WP?$WP:[]).push({id:"@ta/attractions.apd-xsells",d:["vendor-babel","vendor-react-libs","vendor-urql","@ta/attractions.attraction-social-proof","@ta/common.features","lithium-platform","@ta/attractions.shelf"],e:["./packages/attractions/apd-xsells/apd-xsells.jsx"],m:{"./packages/attractions/apd-xsells/apd-xsells.jsx":function(e,i,n){"use strict";n.r(i);var a=n("@babel/runtime/helpers/esm/extends"),t=n.n(a),l=n("@babel/runtime/helpers/esm/slicedToArray"),d=n.n(l),r=n("@babel/runtime/helpers/esm/defineProperty"),o=n.n(r),u=n("react"),m=n("urql"),s=n("@ta/attractions.attraction-social-proof"),c=n("@ta/common.features"),v=n("@ta/lithium.context"),k=n("@ta/attractions.shelf"),p=n.n(k),f=n("@ta/platform.i18n"),g=JSON.parse('{"kind":"Document","definitions":[{"kind":"OperationDefinition","operation":"query","name":{"kind":"Name","value":"ApdShelfQuery"},"variableDefinitions":[{"kind":"VariableDefinition","variable":{"kind":"Variable","name":{"kind":"Name","value":"currency"}},"type":{"kind":"NonNullType","type":{"kind":"NamedType","name":{"kind":"Name","value":"String"}}},"directives":[]},{"kind":"VariableDefinition","variable":{"kind":"Variable","name":{"kind":"Name","value":"geoId"}},"type":{"kind":"NonNullType","type":{"kind":"NamedType","name":{"kind":"Name","value":"Int"}}},"directives":[]},{"kind":"VariableDefinition","variable":{"kind":"Variable","name":{"kind":"Name","value":"detailId"}},"type":{"kind":"NonNullType","type":{"kind":"NamedType","name":{"kind":"Name","value":"Int"}}},"directives":[]},{"kind":"VariableDefinition","variable":{"kind":"Variable","name":{"kind":"Name","value":"locale"}},"type":{"kind":"NonNullType","type":{"kind":"NamedType","name":{"kind":"Name","value":"String"}}},"directives":[]},{"kind":"VariableDefinition","variable":{"kind":"Variable","name":{"kind":"Name","value":"userId"}},"type":{"kind":"NamedType","name":{"kind":"Name","value":"String"}},"directives":[]},{"kind":"VariableDefinition","variable":{"kind":"Variable","name":{"kind":"Name","value":"taUnique"}},"type":{"kind":"NamedType","name":{"kind":"Name","value":"String"}},"directives":[]}],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","alias":{"kind":"Name","value":"productDetails"},"name":{"kind":"Name","value":"ExpPresentationService_getFullProductDetailsBulk"},"arguments":[{"kind":"Argument","name":{"kind":"Name","value":"activityIds"},"value":{"kind":"ListValue","values":[{"kind":"Variable","name":{"kind":"Name","value":"detailId"}}]}},{"kind":"Argument","name":{"kind":"Name","value":"currency"},"value":{"kind":"Variable","name":{"kind":"Name","value":"currency"}}}],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"shelfGroup"},"arguments":[{"kind":"Argument","name":{"kind":"Name","value":"currency"},"value":{"kind":"Variable","name":{"kind":"Name","value":"currency"}}},{"kind":"Argument","name":{"kind":"Name","value":"geoId"},"value":{"kind":"Variable","name":{"kind":"Name","value":"geoId"}}},{"kind":"Argument","name":{"kind":"Name","value":"detailId"},"value":{"kind":"Variable","name":{"kind":"Name","value":"detailId"}}},{"kind":"Argument","name":{"kind":"Name","value":"locale"},"value":{"kind":"Variable","name":{"kind":"Name","value":"locale"}}},{"kind":"Argument","name":{"kind":"Name","value":"maxItems"},"value":{"kind":"IntValue","value":"4"}},{"kind":"Argument","name":{"kind":"Name","value":"shelfGroup"},"value":{"kind":"EnumValue","value":"ATTRACTION_PRODUCT_DETAIL_CROSS_SELLS"}},{"kind":"Argument","name":{"kind":"Name","value":"userContext"},"value":{"kind":"ObjectValue","fields":[{"kind":"ObjectField","name":{"kind":"Name","value":"userId"},"value":{"kind":"Variable","name":{"kind":"Name","value":"userId"}}},{"kind":"ObjectField","name":{"kind":"Name","value":"taUnique"},"value":{"kind":"Variable","name":{"kind":"Name","value":"taUnique"}}}]}},{"kind":"Argument","name":{"kind":"Name","value":"shelfLimit"},"value":{"kind":"IntValue","value":"4"}},{"kind":"Argument","name":{"kind":"Name","value":"shelfOptions"},"value":{"kind":"ListValue","values":[{"kind":"ObjectValue","fields":[{"kind":"ObjectField","name":{"kind":"Name","value":"shelfType"},"value":{"kind":"EnumValue","value":"APFilter"}},{"kind":"ObjectField","name":{"kind":"Name","value":"maxItems"},"value":{"kind":"IntValue","value":"6"}}]}]}}],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"shelves"},"arguments":[],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"shelfType"},"arguments":[],"directives":[]},{"kind":"Field","name":{"kind":"Name","value":"shelfTitleLocalized"},"arguments":[],"directives":[]},{"kind":"Field","name":{"kind":"Name","value":"shelfSubTitleLocalized"},"arguments":[],"directives":[]},{"kind":"Field","name":{"kind":"Name","value":"shelfItems"},"arguments":[],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"InlineFragment","typeCondition":{"kind":"NamedType","name":{"kind":"Name","value":"ExpShelves_ProductShelfItem"}},"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"__typename"},"arguments":[],"directives":[]},{"kind":"Field","alias":{"kind":"Name","value":"shelfItemType"},"name":{"kind":"Name","value":"type"},"arguments":[],"directives":[]},{"kind":"Field","name":{"kind":"Name","value":"productCode"},"arguments":[],"directives":[]},{"kind":"Field","name":{"kind":"Name","value":"productInformation"},"arguments":[{"kind":"Argument","name":{"kind":"Name","value":"currency"},"value":{"kind":"Variable","name":{"kind":"Name","value":"currency"}}}],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"name"},"arguments":[],"directives":[]},{"kind":"Field","name":{"kind":"Name","value":"activityId"},"arguments":[],"directives":[]},{"kind":"Field","name":{"kind":"Name","value":"attractionProductId"},"arguments":[],"directives":[]},{"kind":"Field","name":{"kind":"Name","value":"displayPriceNoRounding"},"arguments":[],"directives":[]},{"kind":"Field","name":{"kind":"Name","value":"displayStrikeThruPriceNoRounding"},"arguments":[],"directives":[]},{"kind":"Field","name":{"kind":"Name","value":"productLabelTags"},"arguments":[],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"productLabel"},"arguments":[],"directives":[]},{"kind":"Field","name":{"kind":"Name","value":"labelType"},"arguments":[],"directives":[]}]}},{"kind":"Field","name":{"kind":"Name","value":"reviewSummary"},"arguments":[],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"rating"},"arguments":[],"directives":[]},{"kind":"Field","name":{"kind":"Name","value":"count"},"arguments":[],"directives":[]}]}},{"kind":"Field","name":{"kind":"Name","value":"url"},"arguments":[],"directives":[]},{"kind":"Field","name":{"kind":"Name","value":"thumbnail"},"arguments":[],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"photoSizes"},"arguments":[],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"url"},"arguments":[],"directives":[]}]}}]}},{"kind":"Field","name":{"kind":"Name","value":"socialProofData"},"arguments":[],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"totalBookings"},"arguments":[],"directives":[]}]}}]}}]}},{"kind":"InlineFragment","typeCondition":{"kind":"NamedType","name":{"kind":"Name","value":"ExpShelves_ProductTaxonomyShelfItem"}},"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"__typename"},"arguments":[],"directives":[]},{"kind":"Field","alias":{"kind":"Name","value":"shelfItemType"},"name":{"kind":"Name","value":"type"},"arguments":[],"directives":[]},{"kind":"Field","name":{"kind":"Name","value":"taxonomyName"},"arguments":[],"directives":[]},{"kind":"Field","name":{"kind":"Name","value":"filteredPageUrl"},"arguments":[],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"relativeUrl"},"arguments":[],"directives":[]},{"kind":"Field","name":{"kind":"Name","value":"urlRouteParameters"},"arguments":[],"directives":[]}]}},{"kind":"Field","name":{"kind":"Name","value":"representativeProduct"},"arguments":[],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"thumbnail"},"arguments":[],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"photoSizes"},"arguments":[],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"url"},"arguments":[],"directives":[]},{"kind":"Field","name":{"kind":"Name","value":"width"},"arguments":[],"directives":[]}]}}]}}]}}]}}]}}]}}]}}]}}]}}],"loc":{"start":0,"end":1951}}');g.__key=0xb60ce9fd30a5,g.loc.source={body:"b60ce9fd30a5"};var N=g;function y(e,i){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);i&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,a)}return n}function S(e){for(var i=1;i<arguments.length;i++){var n=null!=arguments[i]?arguments[i]:{};i%2?y(n,!0).forEach(function(i){o()(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(n).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}var b=function e(i,n){return n?"horizontal_small":i?"grid_3xN_slim":"grid_4xN"},h=function e(i){if(!i||0===i.length)return null;var n=i[0];return{localizedText:(null==n?void 0:n.productLabel)||"",tagProperty:"BEST_SELLER"===(null==n?void 0:n.labelType)?"primary":"secondary"}},I=function e(i){return"APFilter"===i.shelfType},F=function e(i){return!!i.shelfItemType&&"ProductTaxonomyShelfItem"===i.shelfItemType},P=function e(i){if(((null==i?void 0:i.length)||0)<3)return{};var n=Array.from(i||[]);return n.sort(function(e,i){return((null==e?void 0:e.width)||0)-((null==i?void 0:i.width)||0)}),{images:{large:n[n.length-1],medium:n[n.length-2],small:n[n.length-3],original:{},thumbnail:{}}}},T=function e(i,n){return Object(c.featureIsEnabled)("attractions_social_proof_message_on_product_shelves_test")&&n>=s.SOCIAL_PROOF_TOTAL_BOOKING_THRESHOLD&&i.string("attraction_product_social_proof_total_bookings_v2",{nTravelerCount:n,sHtml1:"",sHtml2:"",sHtml3:"",sHtml4:""})};i.default=function e(){var i=u.useContext(v.Route),n=d()(i,1)[0],a=u.useContext(v.Preference).currency,l=u.useContext(v.Environment).locale,r=u.useContext(v.Visitor).userId,o=u.useContext(v.Device),s=o.id,c=o.viewportCategory,k=Object(f.useLocalize)().localize,g="MOBILE"===c;if("AttractionProductReview"!==n.page)return null;var y=n.params,_=y.geoId,O=y.detailId;return _&&O?u.createElement(m.Query,{query:N,variables:{currency:a,geoId:+_,detailId:+O,locale:l.language,userId:r,taUnique:s}},function(e){var i,n,a,l,d,r,o=e.data;return(null==o?void 0:null===(i=o.productDetails)||void 0===i?void 0:null===(n=i[0])||void 0===n?void 0:null===(a=n.shelfGroup)||void 0===a?void 0:a.shelves)?((null==o?void 0:null===(l=o.productDetails)||void 0===l?void 0:null===(d=l[0])||void 0===d?void 0:null===(r=d.shelfGroup)||void 0===r?void 0:r.shelves)||[]).map(function(e,i){return u.createElement(p.a,t()({},function e(i,n,a){return{title:i.shelfTitleLocalized||"",subtitle:i.shelfSubTitleLocalized||"",layout:b(I(i),a),index:n}}(e,i,g),{key:"shelf_".concat(e.shelfType)}),e.shelfItems.map(function(e,n){return function e(i,n,a,t,l){var d,r,o,u,m,s,c,v,k,p,f,g,N,y,I,_,O,x,V,A,D,L,E,j,C={shelfIndex:n,index:a,layout:b(F(i),t)};if(!i.__typename)return null;switch(i.__typename){case"ExpShelves_ProductTaxonomyShelfItem":return S({},C,{taxonomy:{id:(null===(d=i.filteredPageUrl)||void 0===d?void 0:null===(r=d.urlRouteParameters)||void 0===r?void 0:r.zfc)||(null===(o=i.filteredPageUrl)||void 0===o?void 0:null===(u=o.urlRouteParameters)||void 0===u?void 0:u.zfg)||-1,name:i.taxonomyName||"",thumbnail:P(null===(m=i.representativeProduct)||void 0===m?void 0:null===(s=m.thumbnail)||void 0===s?void 0:s.photoSizes),shelfIndex:n,url:(null===(c=i.filteredPageUrl)||void 0===c?void 0:c.relativeUrl)||"",linkOptions:{target:"_blank"}}});case"ExpShelves_ProductShelfItem":return S({},C,{product:{locationId:(null===(v=i.productInformation)||void 0===v?void 0:v.activityId)||0,productId:(null===(k=i.productInformation)||void 0===k?void 0:k.attractionProductId)||0,productCode:i.productCode||"",title:(null===(p=i.productInformation)||void 0===p?void 0:p.name)||"",fromPrice:(null===(f=i.productInformation)||void 0===f?void 0:f.displayPriceNoRounding)||"",strikethruPrice:(null===(g=i.productInformation)||void 0===g?void 0:g.displayStrikeThruPriceNoRounding)||"",url:(null===(N=i.productInformation)||void 0===N?void 0:N.url)||"",rating:(null===(y=i.productInformation)||void 0===y?void 0:null===(I=y.reviewSummary)||void 0===I?void 0:I.rating)||0,reviewCount:(null===(_=i.productInformation)||void 0===_?void 0:null===(O=_.reviewSummary)||void 0===O?void 0:O.count)||0,imgUrl:(null===(x=i.productInformation)||void 0===x?void 0:null===(V=x.thumbnail)||void 0===V?void 0:null===(A=V.photoSizes)||void 0===A?void 0:null===(D=A[3])||void 0===D?void 0:D.url)||"",shelfIndex:n,placement:a,productLabelTag:h(null===(L=i.productInformation)||void 0===L?void 0:L.productLabelTags),fromPriceFormat:"BASIC",linkOptions:{target:"_blank"},socialProofTotalBookingsMessage:(null===(E=i.productInformation)||void 0===E?void 0:null===(j=E.socialProofData)||void 0===j?void 0:j.totalBookings)&&T(l,i.productInformation.socialProofData.totalBookings)||""}});default:return null}}(e,i,n,g,k)}))}):null}):null}}}});
//# sourceMappingURL=attractions.apd-xsells.1b14e2a8ff.js.map