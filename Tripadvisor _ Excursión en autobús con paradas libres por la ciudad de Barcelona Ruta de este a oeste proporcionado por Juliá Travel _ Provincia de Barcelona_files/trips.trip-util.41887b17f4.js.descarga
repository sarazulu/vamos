($WP="undefined"!=typeof $WP?$WP:[]).push({id:"@ta/trips.trip-util",d:["vendor-babel","@ta/common.features","@ta/trips.trip-types","@ta/trips.graphql"],e:["./packages/trips/trip-util/trip-util.jsx"],m:{"./packages/trips/trip-util/trip-util.jsx":function(t,e,r){"use strict";r.r(e),r.d(e,"getTripCoverPhoto",function(){return d}),r.d(e,"getTripUsers",function(){return l}),r.d(e,"isTripUser",function(){return m}),r.d(e,"userTypeFromTrip",function(){return v}),r.d(e,"getTripPermissions",function(){return b}),r.d(e,"getCollabPermissions",function(){return P}),r.d(e,"getItemPermissions",function(){return y}),r.d(e,"getCommentPermissions",function(){return O}),r.d(e,"getTripUsersForDisplay",function(){return h}),r.d(e,"getCommentsForDisplay",function(){return g}),r.d(e,"isOwner",function(){return I}),r.d(e,"userRelation",function(){return _}),r.d(e,"getItemByReference",function(){return w}),r.d(e,"getItemIdByReference",function(){return T}),r.d(e,"getReferenceTypeFromObjectType",function(){return k}),r.d(e,"getQueryReferenceTypeFromObjectType",function(){return E}),r.d(e,"locationsForItem",function(){return A}),r.d(e,"toSavesObject",function(){return N}),r.d(e,"toReference",function(){return V}),r.d(e,"buildPublicTripShareUrl",function(){return F}),r.d(e,"objectStatisticQuery",function(){return D}),r.d(e,"isRepostSaveable",function(){return z}),r.d(e,"windowOpener",function(){return U}),r.d(e,"getPhotoSizesForLinkPost",function(){return W});var n=r("@babel/runtime/helpers/esm/slicedToArray"),o=r.n(n),i=r("@babel/runtime/helpers/esm/toConsumableArray"),c=r.n(i),u=r("@babel/runtime/helpers/esm/defineProperty"),a=r.n(u),s=r("@ta/common.features"),p=(r("@ta/trips.trip-types"),r("@ta/trips.graphql"));function f(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}var d=function t(e){return e.photo&&e.photo.photoSizes[e.photo.photoSizes.length-1]?e.photo.photoSizes[e.photo.photoSizes.length-1]:null},l=function t(e){var r=e.owner||e.userProfile,n=r?[r]:[];if(Object(s.featureIsEnabled)("trips_2018_collab")){var o=(e.collaborators||[]).map(function(t){return t.user}).filter(Boolean);n=n.concat(o)||[]}return n},m=function t(e,r){return l(e).some(function(t){return t.isMe||t.userId&&t.userId===r||t.id&&t.id===r})},v=function t(e){var r;return(null===(r=e.owner)||void 0===r?void 0:r.isMe)?"OWNER":e&&m(e)?"COLLABORATOR":"PUBLIC"},b=function t(e,r){return Object(s.featureIsEnabled)("trips_2018_collab")?e.actionPermissions:{canAddCollaborators:r,canAddItem:r,canChangePrivacy:r,canDelete:r,canEdit:r,canUploadCoverPhoto:e.actionPermissions&&e.actionPermissions.canUploadCoverPhoto&&r}},P=function t(e,r){return Object(s.featureIsEnabled)("trips_2018_collab")?e.actionPermissions:{canRemove:r}},y=function t(e,r){return Object(s.featureIsEnabled)("trips_2018_collab")?e.actionPermissions:{canAddComment:r,canEdit:r,canRemove:r}},O=function t(e,r){return Object(s.featureIsEnabled)("trips_2018_collab")?e.actionPermissions:{canEdit:r,canRemove:r}},h=function t(e,r,n,o){var i=l(e);if(i=i.slice(0,r),n>0){var c=0;i=i.filter(function(t){return(c=t.displayName.length+c)<n})}return o&&(i=i.reverse()),i},g=function t(e,r,n){var o=n&&n.id,i=Object(s.featureIsEnabled)("trips_2018_collab")?function(){return!0}:function(t){return t.author.id===o||"ITEM"===t.targetType&&t.targetId!==e.id};return(r||[]).filter(i).sort(function t(e,r){return e.created>r.created?1:-1})},I=function t(e){var r;return null==e?void 0:null===(r=e.owner)||void 0===r?void 0:r.isMe},_=function t(e){return e.owner&&e.owner.isMe?"OWNER":m(e)?"COLLABORATOR":"VIEWER"},w=function t(e,r){return(e.items||[]).find(function(t){var e,n=t.reference&&t.reference.type&&t.reference.type.toLowerCase(),o=null===(e=t.reference)||void 0===e?void 0:e.id,i=r.type.toLowerCase(),c=r.id.toString(),u=r.originalObject&&r.originalObject.type&&r.originalObject.type.toLowerCase(),a=r.originalObject&&r.originalObject.id.toString();return n===i&&o===c||n===u&&o===a})},T=function t(e,r){var n=w(e,r);return n?n.id:null},j={locationinformation:"location",attractionproductinformation:"attractionProduct",forumpost:"post",tripitem:"savesItem",linkpost:"link",linkpost_linkpostv2:"link",photo:"photo",video:"video",review:"review",repost:"repost",trip:"bundleSave",tripnotes_tripnote:"note"},R={locationinformation:"LOCATION",attractionproductinformation:"ATTRACTIONPRODUCT",forumpost:"POST",tripitem:"SAVESITEM",linkpost:"LINK",photo:"PHOTO",video:"VIDEO",review:"REVIEW",repost:"REPOST",trip:"TRIPCONTENT"},S=function t(e){return{statQuery:e}},L=Object.freeze({location:S(p.LocationStatistics),attractionProduct:S(p.AttractionStatistics),post:S(p.ForumStatistics),savesItem:S(p.TripItemStatistics),link:S(p.LinkPostStatistics),review:S(p.ReviewStatistics),photo:S(p.PhotoStatistics),video:S(p.VideoStatistics),repost:S(p.RepostStatistics)}),k=function t(e){return j[e.toLowerCase()]},E=function t(e){return R[e.toLowerCase()]},C=["LocationInformation","AttractionProductInformation","ForumPost","LinkPost","LinkPost_LinkPostV2","Review","Photo","Video","Repost","Trip","TripNotes_TripNote"],A=function t(e){switch(e.__typename){case"AttractionProductInformation":case"LocationInformation":return[e];case"Photo":case"Review":return[e.location];case"Video":return e.orderedLocations;case"ForumPost":case"LinkPost":case"TripNote":default:return[]}},N=function t(e,r){if(!e)return null;var n=function t(e){return e.locationId||e.attractionProductId||e.postId||e.repostId||e.linkPostId||e.id||void 0}(e),o=e.__typename?k(e.__typename):null;if(n&&o){if(C.includes(e.__typename))return{type:o,id:n};var i={id:e.reference.id,type:"attractionproduct"===e.reference.type?"attractionProduct":e.reference.type};if("TripItem"===e.__typename&&e.reference&&e.reference.id&&e.reference.type)return r&&"note"!==i.type?i:{type:o,id:n,originalObject:i}}return null},V=function t(e){return{id:"".concat(e.id),type:e.type}},F=function t(e,r){var n=r?"?itemId=".concat(r):"";return"/Trips/".concat(e).concat(n)},D=function t(e){var r=L[e.type];return r?function n(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?f(r,!0).forEach(function(e){a()(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):f(r).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}({},e,{query:r.statQuery,variables:{ids:[e.id]}}):null},z=function t(e){var r,n;return["LinkPost","Photo","Review","Video"].includes(null==e?void 0:null===(r=e.object)||void 0===r?void 0:null===(n=r.repostedObject)||void 0===n?void 0:n.__typename)},U=function t(e,r){if("_blank"===r){var n=window.open("about:blank",r);return function(){n.location=e}}return function(){window.open(e,r)}};function B(t,e){return t.reduce(function(t,r){return e(r)?t[0].push(r):t[1].push(r),t},[[],[]])}var W=function t(e){if("LinkPost_LinkPostV2"===e.__typename){var r=e.preview&&e.preview.media||[];if(!r.length)return[];var n=B(r=r.reduce(function(t,e){return e&&e.object?[].concat(c()(t),[e]):t},[]).sort(function(t,e){return e.id-t.id}),function(t){return"LinkPreview_PhotoRefV2"===t.__typename}),i=o()(n,2),u=i[0],a=i[1];if(u.length){var s=o()(u,1)[0];return s.object&&s.object.photoSizes||[]}if(a.length){var p=o()(a,1)[0];return p.object?[p.object]:[]}}if("LinkPost"===e.__typename){var f=e.preview&&e.preview.media||[];if(!f.length)return[];var d=function t(e){return e.photoId||e.previewId||0},l=B(f=f.filter(Boolean).sort(function(t,e){return d(e)-d(t)}),function(t){return"Photo"===t.__typename}),m=o()(l,2),v=m[0],b=m[1];if(v.length)return o()(v,1)[0].photoSizes||[];if(b.length)return[b[0]]}return[]}}}});
//# sourceMappingURL=trips.trip-util.41887b17f4.js.map