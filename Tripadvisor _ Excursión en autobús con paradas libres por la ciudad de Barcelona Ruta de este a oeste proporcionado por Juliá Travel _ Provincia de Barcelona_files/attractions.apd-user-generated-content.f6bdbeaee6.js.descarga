($WP="undefined"!=typeof $WP?$WP:[]).push({id:"@ta/attractions.apd-user-generated-content",d:["vendor-react-libs","lithium-platform","vendor-babel","@ta/reviews.types","@ta/reviews.context","@ta/reviews.content-collection-footer","@ta/attractions.viator-review","@ta/attractions.question-answer","@ta/attractions.product-detail-data-loader","@ta/common.features","lithium-common","@ta/styleguide.grouping-tabs","@ta/styleguide.skeleton","@ta/reviews.layout","@ta/reviews.card","@ta/reviews.questions","@ta/reviews.contextual-cta","@ta/platform.interactions","@ta/core-ui.grid","@ta/reviews.filters-ui","lithium-routes","@ta/modal.slide-in","@ta/platform.impressions","@ta/reviews.skeletons"],e:["./packages/attractions/apd-user-generated-content/apd-user-generated-content.jsx"],m:{"./packages/attractions/apd-user-generated-content/EventDate.jsx":function(e,t,a){"use strict";var n=a("react"),r=a("@ta/platform.i18n");t.a=function e(t){var a=Object(r.useIntlFormatter)();if(t.date){var i={0:"_3iEp3tNE",1:a.formatDate("date_full_month_year",new Date(t.date))};return n.createElement("div",{className:"_30IBqsJg"},n.createElement(r.UnsafeLocalize,{id:"Date_of_experience",args:i}))}return null}},"./packages/attractions/apd-user-generated-content/apd-user-generated-content.jsx":function(e,t,a){"use strict";a.r(t);var n,r=a("@babel/runtime/helpers/esm/slicedToArray"),i=a.n(r),o=a("react"),l=a("@ta/reviews.types"),c=a("@ta/lithium.context"),s=a("@ta/reviews.context"),u=a("@ta/reviews.content-collection-footer"),d=a.n(u),g=a("@ta/attractions.viator-review"),m=a.n(g),v=a("@ta/attractions.question-answer"),p=a.n(v),_=a("@ta/attractions.product-detail-data-loader"),f=a("@ta/common.features"),E=new Set(["Questions"]),w=a("@babel/runtime/helpers/esm/defineProperty"),b=a.n(w),y=a("@ta/common.classnames"),T=a.n(y),C=a("@ta/common.is-visible"),S=a("@ta/reviews.questions"),L=a("@ta/platform.interactions"),O=a("@babel/runtime/helpers/esm/toConsumableArray"),R=a.n(O),h=a("@ta/core-ui.grid"),k=a("@ta/reviews.filters-ui"),F=a("@ta/lithium.router"),P=a("@ta/config.pages"),I=a("@ta/modal.slide-in"),A=a.n(I),x=a("@ta/platform.i18n"),N=a.n(x),j=a("@ta/platform.import"),D=a("@ta/platform.impressions"),M=a("@ta/reviews.skeletons"),V=a.n(M),U=a("./packages/attractions/apd-user-generated-content/useUpdateReviewUrl.jsx"),H=j.component.onUsage(((n=function e(){return a.e("@ta/attractions.apd-user-generated-content/ReviewList.demand").then(a.bind(null,"./packages/attractions/apd-user-generated-content/ReviewList.jsx"))}).__PACKAGE__="@ta/attractions.apd-user-generated-content",n.__MODULE_ID__="./packages/attractions/apd-user-generated-content/ReviewList.jsx",n.__MODULE_NAME__="ReviewList",n.__BUNDLE_NAME__="@ta/attractions.apd-user-generated-content/ReviewList.demand",n.__GET_SYNC__=function(){return a.m["./packages/attractions/apd-user-generated-content/ReviewList.jsx"]?a("./packages/attractions/apd-user-generated-content/ReviewList.jsx"):null},n.__IS_LOADED__=function(){return void 0!==a.m["./packages/attractions/apd-user-generated-content/ReviewList.jsx"]},n),"default"),B=j.component.onUsage(function(){var e=function e(){return a.e("@ta/attractions.apd-user-generated-content/ReviewPagination.demand").then(a.bind(null,"./packages/attractions/apd-user-generated-content/ReviewPagination.jsx"))};return e.__PACKAGE__="@ta/attractions.apd-user-generated-content",e.__MODULE_ID__="./packages/attractions/apd-user-generated-content/ReviewPagination.jsx",e.__MODULE_NAME__="ReviewPagination",e.__BUNDLE_NAME__="@ta/attractions.apd-user-generated-content/ReviewPagination.demand",e.__GET_SYNC__=function(){return a.m["./packages/attractions/apd-user-generated-content/ReviewPagination.jsx"]?a("./packages/attractions/apd-user-generated-content/ReviewPagination.jsx"):null},e.__IS_LOADED__=function(){return void 0!==a.m["./packages/attractions/apd-user-generated-content/ReviewPagination.jsx"]},e}(),"default"),Q=j.component.onUsage(function(){var e=function e(){return a.e("@ta/attractions.apd-user-generated-content/ViatorLink.demand").then(a.bind(null,"./packages/attractions/apd-user-generated-content/ViatorLink.jsx"))};return e.__PACKAGE__="@ta/attractions.apd-user-generated-content",e.__MODULE_ID__="./packages/attractions/apd-user-generated-content/ViatorLink.jsx",e.__MODULE_NAME__="ViatorLink",e.__BUNDLE_NAME__="@ta/attractions.apd-user-generated-content/ViatorLink.demand",e.__GET_SYNC__=function(){return a.m["./packages/attractions/apd-user-generated-content/ViatorLink.jsx"]?a("./packages/attractions/apd-user-generated-content/ViatorLink.jsx"):null},e.__IS_LOADED__=function(){return void 0!==a.m["./packages/attractions/apd-user-generated-content/ViatorLink.jsx"]},e}(),"default"),G=function e(t){var a,n,r,l,u,d,g,m,v,p,f,E=t.totalReviewsCount,w=o.useContext(c.Route),b=i()(w,2),y=b[0],T=y.params,C=y.path,S=b[1].navigate,L=o.useContext(c.Environment).locale,O=o.useContext(c.Device).viewportCategory,I=Object(x.useLocalize)().localize,j=o.useState(!1),M=i()(j,2),G=M[0],q=M[1],K="MOBILE"===O,Y=T.detailId||-1,W=function e(t){var a=t&&"".concat(t).match(/r(\d+)/)||["r0","0"];return+i()(a,2)[1]}(T.offset||""),$=Object(U.a)(C,0),z=o.useCallback(function(){if(W>0){var e=Object(F.getRouteFromPath)($);Object(P.isRoutable)(e)&&e&&e.params&&S(e,"FRAGMENT_PUSH")}},[S,W,$]),J=Object(s.useReviewFilterState)({onFilterChange:z}),Z=J.rating,X=J.toggleRating,ee=J.travelType,te=J.toggleTravelType,ae=J.travelTime,ne=J.toggleTravelTime,re=J.healthSafety,ie=J.toggleHealthSafety,oe=J.languageFilter,le=J.setLanguageFilter,ce=J.keywordFilter,se=J.setKeywordFilter,ue=J.searchFilter,de=J.debouncedSearchFilter,ge=J.setSearchFilter,me=J.isDefaultFilters,ve=J.clearFilters,pe=Object(s.useReviewPrefsState)(),_e=pe.showMT,fe=pe.setShowMT,Ee=pe.sortType,we=pe.isDefaultPrefs,be=Object(s.useQueryReviewsList)({locationId:Y,offset:W,limit:5,isDefaultFilters:me,rating:Z,travelTime:ae,travelType:ee,healthSafety:re,contentLanguage:oe,keywords:ce,keywordVariant:"location_keywords_v2_llr_order_30_".concat(Object(s.contentLangFromLocale)(L.code)),searchText:de,isDefaultPrefs:we,showMT:_e,sortType:Ee}),ye=i()(be,1)[0],Te=ye.fetching,Ce=ye.data,Se=o.useCallback(function(e){se({type:"ADD",value:e}),ge({type:"ADD",value:e})},[se,ge]),Le=o.useCallback(function(e){se({type:"REMOVE",value:e}),ge({type:"REMOVE",value:e})},[se,ge]),Oe=o.useCallback(function(){se({type:"CLEAR"}),ge({type:"CLEAR"})},[se,ge]),Re=o.useCallback(function(e){se({type:"MATCH",value:e}),ge({type:"SET",value:e})},[se,ge]),he=o.useCallback(function(){ge({type:"CLEAR"}),se({type:"CLEAR"})},[ge,se]),ke=Object(_.useFullProductData)().fullProduct;if(function e(t){var a=o.useContext(c.Environment).locale.language,n=o.useContext(D.AddPageProperty);o.useEffect(function(){if(t)if(0!==t.length){var e,r=!1,i=!1,o=!1,l=!0,c=!1,s=!1,u=!0,d=!0,g=!0,m=!1;t.forEach(function(e){var t;e&&("MACHINE"===e.translationType?i=!0:l=!1,(null===(t=e.provider)||void 0===t?void 0:t.isLocalProvider)?(c=!0,g=!1):(s=!0,d=!1,o=!0),a!==e.language||e.translationType?u=!1:r=!0,"HUMAN"===e.translationType&&(m=!0))}),e=!r,r&&n("POS_Organic_Local_Language_Reviews"),i&&n("POS_MT_Reviews"),o&&n("POS_Partner_Reviews"),e&&n("POS_Organic_Local_Language_Reviews_NO"),l&&n("POS_Only_MT_Reviews"),c&&n("POS_Crawlable_Reviews_Content"),s&&n("POS_Crawlable_Reviews_Content_NO"),u&&n("POS_Only_Organic_Local_Language_Reviews"),d&&n("POS_ONLY_Crawlable_Reviews_Content"),g&&n("POS_ONLY_Crawlable_Reviews_Content_NO"),m&&n("POS_Has_Human_Translated_Reviews")}else n("POS_No_Review_Content")},[n,a,t])}(Te?null:(null==Ce?void 0:null===(a=Ce.locations)||void 0===a?void 0:null===(n=a[0])||void 0===n?void 0:null===(r=n.reviewListPage)||void 0===r?void 0:r.reviews)||[]),Te&&!Ce)return o.createElement(o.Fragment,null,R()(Array(5)).map(function(e,t){return o.createElement(V.a,{key:t.toString()})}));if(0===E)return null;var Fe,Pe=Ce&&Ce.locations&&Ce.locations[0],Ie=null==Pe?void 0:Pe.placeType,Ae=null==Pe?void 0:null===(l=Pe.reviewListPage)||void 0===l?void 0:l.reviews,xe=(null==Pe?void 0:null===(u=Pe.reviewListPage)||void 0===u?void 0:u.totalCount)||0,Ne=((null==Pe?void 0:null===(d=Pe.keywords)||void 0===d?void 0:d.keywords)||[]).map(function(e){return null==e?void 0:e.keyword}),je=(null==ke?void 0:null===(g=ke.title)||void 0===g?void 0:g.text)||(null==Pe?void 0:Pe.name)||(null==Pe?void 0:null===(m=Pe.additionalNames)||void 0===m?void 0:m.normal)||(null==Pe?void 0:null===(v=Pe.additionalNames)||void 0===v?void 0:v.long),De=(null==Pe?void 0:null===(p=Pe.currentUserOwnerStatus)||void 0===p?void 0:p.isValid)||!1;Ce&&Ce.locations&&Ce.locations[0]&&Ce.locations[0].reviewAggregations&&(Fe=Ce.locations[0].reviewAggregations);var Me="en"===Object(s.contentLangFromLocale)(L.code);["all","en"].includes(oe)||(Me=!1);var Ve=o.createRef();return o.createElement(o.Fragment,null,Fe&&o.createElement(o.Fragment,null,o.createElement("div",{ref:Ve,className:"yh7F6Hkz"},o.createElement(h.Grid,null,o.createElement(h.Row,{gapless:K},o.createElement(h.Column,{width:K?12:5},o.createElement(k.ReviewRatingFilter,{reviewAggregations:Fe,rating:Z,toggleRating:X,placeType:Ie})),!K&&o.createElement(o.Fragment,null,o.createElement(h.Column,null,o.createElement(k.TravelerTypeFilter,{travelType:ee,toggleTravelType:te,placeType:Ie})),o.createElement(h.Column,null,o.createElement(k.TravelTimeFilter,{travelTime:ae,toggleTravelTime:ne,placeType:Ie})),o.createElement(h.Column,null,o.createElement(k.LanguageFilter,{reviewAggregations:Fe,placeType:Ie,selectedLanguage:oe,setLanguageFilter:le})))),!K&&0!==Fe.alertStatusCount&&o.createElement(k.HealthSafetyFilter,{reviewAggregations:Fe,healthSafety:re,toggleHealthSafety:ie}),K&&o.createElement(o.Fragment,null,o.createElement(k.SelectedFilters,{showOverlay:function e(){return q(!0)},ratingFilterValue:Z,clearRatingFilter:function e(t){return X(t)},travelTypeFilterValue:ee,clearTravelTypeFilterValue:function e(t){return te(t)},travelTimeFilterValue:ae,clearTravelTimeFilterValue:function e(t){return ne(t)},languageFilterValue:oe,clearLanguageFilterValue:function e(){return le("all")},queryFilterValue:de,clearQueryFilterValue:he}),function e(){return o.createElement(A.a,{isOpen:G,slideFrom:"right",onClose:function e(){return q(!1)},header:o.createElement(o.Fragment,null,o.createElement("div",{className:"_1AEb4riy"},I("filter_reviews")),o.createElement("div",{className:"f0xGy8Jh"},o.createElement(N.a,{id:"num_results_plural",args:{0:xe||0}})))},o.createElement("div",{className:"_1np4nLnZ"},o.createElement("div",{className:"_1dQ7YrHR"},o.createElement(k.ReviewRatingFilter,{displayType:"dropdown",reviewAggregations:Fe,rating:Z,placeType:Ie,toggleRating:X})),o.createElement("div",{className:"_1dQ7YrHR"},o.createElement(k.TravelerTypeFilter,{displayType:"dropdown",travelType:ee,placeType:Ie,toggleTravelType:te})),o.createElement("div",{className:"_1dQ7YrHR"},o.createElement(k.TravelTimeFilter,{displayType:"dropdown",placeType:Ie,travelTime:ae,toggleTravelTime:ne})),o.createElement("div",{className:"_1dQ7YrHR"},o.createElement(k.LanguageFilter,{displayType:"dropdown",reviewAggregations:Fe,placeType:Ie,selectedLanguage:oe,setLanguageFilter:le})),0!==Fe.alertStatusCount&&o.createElement("div",{className:"_1dQ7YrHR"},o.createElement(k.HealthSafetyFilter,{displayType:"dropdown",reviewAggregations:Fe,healthSafety:re,toggleHealthSafety:ie}))))}()),Me&&o.createElement(h.Row,{gapless:K},o.createElement(h.Column,{width:12},o.createElement(k.KeywordFilter,{availableKeywords:Ne,keywordsSelected:ce,clearKeywords:Oe,addKeyword:Se,removeKeyword:Le,placeType:Ie}))))),o.createElement(k.SearchBoxFilter,{query:ue,setQuery:Re,clearQuery:he,placeType:Ie})),Ae&&o.createElement(H,{reviews:Ae,locationName:je,isActiveOwner:De,setShowMT:fe,showMT:_e,isDefaultFilters:me,clearFilters:ve}),W+5>=xe&&o.createElement(Q,{productCode:null==ke?void 0:ke.productCode,ratingCount:null==ke?void 0:null===(f=ke.reviewSummary)||void 0===f?void 0:f.viatorRatingCount}),xe>5&&o.createElement(B,{offset:W,limit:5,totalCount:xe,path:C,onClick:function e(){Ve.current&&Ve.current.scrollIntoView({behavior:"smooth",block:"start"})}}))},q=function e(t){var a=t.module,n=t.trackingCallback,r=t.component,i=t.isSelectedTab;return i?o.createElement("div",{key:a},o.createElement(C.HasBeenVisible,{onVisible:function e(){i&&n()}},function(e){return o.createElement("div",{ref:e,className:T()(b()({},"D6uQ-Fb4",!i)),"data-test-target":"".concat(a,"-tab")},r)})):null},K=function e(t){var a=Object(L.useGARecorder)();return[{module:"reviews",component:o.createElement(G,{totalReviewsCount:t.reviewsCount}),trackingEnabled:!1,trackingCallback:function e(){},isSelectedTab:t.selectedTab===l.REVIEWS_TAB},{module:"faq",component:o.createElement(S.QuestionsTabContent,{totalQuestionsCount:t.questionsCount,scrollToIdOnPaginationClick:"REVIEWS",scrollOffset:66}),trackingEnabled:!0,trackingCallback:function e(){a({module:"faq",action:"in_view"})},isSelectedTab:t.selectedTab===l.QUESTIONS_TAB}].map(q)},Y=a("@ta/reviews.layout"),W=a("@ta/reviews.card"),$=a("@ta/reviews.contextual-cta"),z=function e(t){switch(t){case l.REVIEWS_TAB:return o.createElement(N.a,{id:"common_Reviews"});case l.QUESTIONS_TAB:return o.createElement(N.a,{id:"mobile_questions_answers"});default:return null}},J=function e(t,a){switch(t){case l.REVIEWS_TAB:return o.createElement(W.ReviewControlNotice,null);case l.QUESTIONS_TAB:return o.createElement(S.SeeAllQuestionsLink,{locationId:a});default:return null}},Z=function e(t){return o.createElement(Y.Section,{section:"reviews",theme:"tabbed-top",joinable:!E.has(t.selectedTab)},o.createElement("div",{className:T()("_2ky0N85J")},o.createElement(Y.ComplexHeader,{text:o.createElement(o.Fragment,null,z(t.selectedTab),J(t.selectedTab,t.locationId)),noDivider:E.has(t.selectedTab)},o.createElement("div",{className:"_6g5imvMC"},o.createElement($.ContextualCTA,{selectedTab:t.selectedTab,locationId:t.locationId,geoId:t.geoId,trackingContext:t.trackingContext,isLoggedIn:t.isLoggedIn})))))},X=a("@ta/core-ui.icon"),ee=a.n(X),te=a("@ta/styleguide.grouping-tabs"),ae=a("@ta/styleguide.skeleton"),ne=a.n(ae);function re(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,n)}return a}function ie(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?re(a,!0).forEach(function(t){b()(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):re(a).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}var oe=function e(t){var a=o.useContext(c.Route),n=i()(a,1)[0].params.detailId||-1,r=Object(x.useLocalize)().localize,u=Object(x.useIntlFormatter)(),d=Object(s.useLocationCommunityContent)({locationId:n}),g=i()(d,1)[0],m=g.fetching,v=g.data,p=v&&v.locations&&v.locations[0]&&v.locations[0].topicCount||0,_=v&&v.locations&&v.locations[0]&&v.locations[0].reviewSummary&&v.locations[0].reviewSummary.count||0;if(0===p&&0===_)return null;if(m)return o.createElement(ne.a,{height:"120px"});var f={onTabClick:t.setSelectedTab,selectedTab:t.selectedTab},E=[ie({tab:l.REVIEWS_TAB,icon:"pencil-paper",count:_,label:r.string("hr_community_tab_reviews",{countClass:"_2HVrMJma",typeClass:"oPeLBveL",count:u.formatNumber("integer",_)})},f),ie({tab:l.QUESTIONS_TAB,icon:"forums",count:p,label:r.string("attractions_community_tab_questions",{countClass:"_2HVrMJma",typeClass:"oPeLBveL",count:u.formatNumber("integer",p)})},f)];return t.children(E)},le=function e(t){return o.createElement(te.GroupingTabs,{elementType:"div"},o.createElement(oe,{setSelectedTab:t.setSelectedTab,selectedTab:t.selectedTab},function(e){return e.map(function(e){return o.createElement(te.GroupingTab,{active:e.tab===t.selectedTab,key:e.tab,onClick:e.count>0?function(){return t.setSelectedTab(e.tab)}:function(){return!1},className:T()("_38xUnR3l",e.count>0?null:"_24uh2Zr5"),elementType:"div"},o.createElement("div",{className:T()("_1f_r3ZBc",e.count>0?null:"_24uh2Zr5"),"data-automation":"UGC_".concat(e.tab,"Tab")},o.createElement(ee.a,{name:e.icon}),o.createElement("span",{className:T()(e.label,e.count>0?"":"_24uh2Zr5"),dangerouslySetInnerHTML:{__html:e.label}})))})}))},ce=function e(t){return o.createElement(o.Fragment,null,o.createElement(le,{selectedTab:t.selectedTab,setSelectedTab:t.setSelectedTab}),o.createElement(Z,{locationId:t.locationId,geoId:t.geoId,selectedTab:t.selectedTab,trackingContext:t.trackingContext,isMobile:t.isMobile,isLoggedIn:t.isLoggedIn}))},se=function e(){var t,a,n,r,u,g=o.useState(l.REVIEWS_TAB),m=i()(g,2),v=m[0],p=m[1],_=o.useContext(c.Device).viewportCategory,f=!!o.useContext(c.Visitor).userId,E=o.useContext(c.Route),w=i()(E,1)[0].params,b=w.detailId||-1,y=w.geoId||-1,T="MOBILE"===_,C=Object(s.useLocationCommunityContent)({locationId:b}),S=i()(C,1)[0],L=S.fetching,O=S.data,R=(null==O?void 0:null===(t=O.locations)||void 0===t?void 0:null===(a=t[0])||void 0===a?void 0:a.topicCount)||0,h=(null==O?void 0:null===(n=O.locations)||void 0===n?void 0:null===(r=n[0])||void 0===r?void 0:null===(u=r.reviewSummary)||void 0===u?void 0:u.count)||0;return o.useEffect(function(){!L&&0===h&&R>0&&p(l.QUESTIONS_TAB)},[L,R,h,p]),o.createElement("div",{className:"RKsX4xGw"},o.createElement(ce,{locationId:b,geoId:y,selectedTab:v,setSelectedTab:p,trackingContext:"Product|Location",isMobile:T,isLoggedIn:f}),o.createElement(K,{selectedTab:v,detailId:b,reviewsCount:h,questionsCount:R}),o.createElement(d.a,{selectedTab:v,locationId:b,trackingContext:"Product|Location",isMobile:T,isLoggedIn:f}))},ue=function e(){return o.createElement(o.Fragment,null,o.createElement(m.a,null),o.createElement(p.a,null))},de=o.memo(function e(){var t,a,n=Object(_.useFullProductData)().fullProduct;return Object(f.featureIsEnabled)("attraction_show_viator_review_module_apr")&&0!==(null==n?void 0:null===(t=n.reviewSummary)||void 0===t?void 0:t.viatorRatingCount)&&0===(null==n?void 0:null===(a=n.reviewSummary)||void 0===a?void 0:a.tripAdvisorRatingCount)?o.createElement(ue,null):o.createElement(se,null)}),ge=a("./packages/attractions/apd-user-generated-content/EventDate.jsx");a.d(t,"EventDate",function(){return ge.a}),t.default=de},"./packages/attractions/apd-user-generated-content/useUpdateReviewUrl.jsx":function(e,t,a){"use strict";t.a=function e(t,a){return t.replace(/-or\d+/,"").replace(/(.+-g\d+-d\d+)(-.+)/,a<=0?"$1$2":"$1-or".concat(a,"$2"))}}}});
//# sourceMappingURL=attractions.apd-user-generated-content.f6bdbeaee6.js.map