($WP="undefined"!=typeof $WP?$WP:[]).push({id:"@ta/social.like-action",d:["vendor-babel","vendor-react-libs","vendor-urql","lithium-platform","@ta/common.use-last-changed","lithium-common","@ta/core-ui.toast","@ta/login.login","@ta/platform.interactions","@ta/social.types"],e:["./packages/social/like-action/LikeAction.jsx"],m:{"./packages/social/like-action/LikeAction.jsx":function(e,i,a){"use strict";a.r(i);var n=a("@babel/runtime/helpers/esm/defineProperty"),t=a.n(n),l=a("@babel/runtime/helpers/esm/slicedToArray"),d=a.n(l),o=a("react"),c=a("urql"),s=a("@ta/common.classnames"),r=a.n(s),u=a("@ta/platform.i18n"),m=a.n(u),k=a("@ta/common.use-last-changed"),v=a.n(k),b=a("@ta/core-ui.icon"),p=a.n(b),N=a("@ta/core-ui.toast"),f=a("@ta/lithium.context"),y=a("@ta/login.login"),j=a.n(y),S=a("@ta/platform.interactions"),g=a("@ta/social.types"),O=a("@ta/platform.urql"),T=JSON.parse('{"kind":"Document","definitions":[{"kind":"OperationDefinition","operation":"query","name":{"kind":"Name","value":"IsLiked"},"variableDefinitions":[{"kind":"VariableDefinition","variable":{"kind":"Variable","name":{"kind":"Name","value":"socialObjects"}},"type":{"kind":"NonNullType","type":{"kind":"ListType","type":{"kind":"NonNullType","type":{"kind":"NamedType","name":{"kind":"Name","value":"SocialObjectInternalInput"}}}}},"directives":[]}],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"socialStatistics"},"arguments":[{"kind":"Argument","name":{"kind":"Name","value":"objects"},"value":{"kind":"Variable","name":{"kind":"Name","value":"socialObjects"}}}],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"isLiked"},"arguments":[],"directives":[]},{"kind":"Field","name":{"kind":"Name","value":"likeCount"},"arguments":[],"directives":[]}]}}]}}],"loc":{"start":0,"end":149}}');T.__key=36984903764013,T.loc.source={body:"21a3380d082d"};var I=T,V=JSON.parse('{"kind":"Document","definitions":[{"kind":"OperationDefinition","operation":"mutation","name":{"kind":"Name","value":"AddLikeLithium"},"variableDefinitions":[{"kind":"VariableDefinition","variable":{"kind":"Variable","name":{"kind":"Name","value":"objectId"}},"type":{"kind":"NamedType","name":{"kind":"Name","value":"String"}},"directives":[]},{"kind":"VariableDefinition","variable":{"kind":"Variable","name":{"kind":"Name","value":"objectType"}},"type":{"kind":"NamedType","name":{"kind":"Name","value":"SocialObjectTypeInput"}},"directives":[]}],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","alias":{"kind":"Name","value":"addLike"},"name":{"kind":"Name","value":"addLikeV2"},"arguments":[{"kind":"Argument","name":{"kind":"Name","value":"socialObject"},"value":{"kind":"ObjectValue","fields":[{"kind":"ObjectField","name":{"kind":"Name","value":"objectType"},"value":{"kind":"Variable","name":{"kind":"Name","value":"objectType"}}},{"kind":"ObjectField","name":{"kind":"Name","value":"objectId"},"value":{"kind":"Variable","name":{"kind":"Name","value":"objectId"}}}]}}],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"statusType"},"arguments":[],"directives":[]}]}}]}}],"loc":{"start":0,"end":197}}');V.__key=32993644241652,V.loc.source={body:"1e01ee71e2f4"};var h=V,L=JSON.parse('{"kind":"Document","definitions":[{"kind":"OperationDefinition","operation":"mutation","name":{"kind":"Name","value":"DeleteLikeLithium"},"variableDefinitions":[{"kind":"VariableDefinition","variable":{"kind":"Variable","name":{"kind":"Name","value":"objectId"}},"type":{"kind":"NamedType","name":{"kind":"Name","value":"String"}},"directives":[]},{"kind":"VariableDefinition","variable":{"kind":"Variable","name":{"kind":"Name","value":"objectType"}},"type":{"kind":"NamedType","name":{"kind":"Name","value":"SocialObjectTypeInput"}},"directives":[]}],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","alias":{"kind":"Name","value":"deleteLike"},"name":{"kind":"Name","value":"deleteLikeV2"},"arguments":[{"kind":"Argument","name":{"kind":"Name","value":"socialObject"},"value":{"kind":"ObjectValue","fields":[{"kind":"ObjectField","name":{"kind":"Name","value":"objectType"},"value":{"kind":"Variable","name":{"kind":"Name","value":"objectType"}}},{"kind":"ObjectField","name":{"kind":"Name","value":"objectId"},"value":{"kind":"Variable","name":{"kind":"Name","value":"objectId"}}}]}}],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"statusType"},"arguments":[],"directives":[]}]}}]}}],"loc":{"start":0,"end":206}}');L.__key=0xa08928ec8bbe,L.loc.source={body:"a08928ec8bbe"};var D=L;i.default=function e(i){var a,n,l=Object(c.useMutation)(h),s=d()(l,2)[1],u=Object(c.useMutation)(D),k=d()(u,2)[1],b=o.useContext(f.Route),y=d()(b,2)[1].uid,T=o.useContext(f.Visitor).userId,V=o.useContext(N.Toast),L=d()(V,1)[0],_=Object(S.useInteractionLogger)(),F=j()(),E=o.useState(null),x=d()(E,2),C=x[0],A=x[1],q=i.socialObject||{objectType:g.SocialObjectTypeMap[i.item.__typename],objectId:String(i.item.id)},P=function e(i){var a=function e(a){var n=a.variables;return String(n.objectId)===String(i.objectId)&&n.objectType===i.objectType?"invalidateAndRefetch":"validate"},n=Object(O.useInvalidatableQuery)({query:I,variables:{socialObjects:[i]},executeWhen:"afterInvalidation"},{addLikeV2:a,deleteLikeV2:a}),t=d()(n,1)[0],l=t.data,o=t.fetching,c=t.error;return!o&&!c&&l&&l.socialStatistics&&l.socialStatistics.length&&l.socialStatistics[0]||null}(q),W=null===(a=i.item)||void 0===a?void 0:null===(n=a.socialStatistics)||void 0===n?void 0:n.isLiked,M=i.onClick;o.useEffect(function(){A(null)},[P]);var R=v()(W,(P||{}).isLiked);R=null===C?R:C;var H=o.useCallback(function(){return R?k(q):s(q)},[R,q,k,s]),J=o.useCallback(function(){return function(e){var i;"NO_PERMISSION"===(null==e?void 0:null===(i=e.addLike)||void 0===i?void 0:i.statusType)&&L({node:o.createElement(N.ToastItem,null,o.createElement(m.a,{id:"social_no_permission"})),timeout:8e3})}},[L]),$=o.useCallback(function(){F({flowOrigin:"login",pid:40469}).then(function(){M&&M();var e={actorUserId:T,uid:y};_({UgcDetail:R?{unhelpful:e}:{helpful:e}}),A(!R)}).then(H).then(J)},[R,A,H,J,F,_,M,T,y]);return o.createElement("div",{className:r()("_1HbRvLf1",t()({},"_1N34czHq",R)),onClick:$},o.createElement("span",{className:"KGnE3rho"},o.createElement(p.a,{name:"thumbs-up-fill",fontSize:20})),o.createElement("span",{className:"_3yWf0wx6"},o.createElement(m.a,{id:"social_Helpful"})))}}}});
//# sourceMappingURL=social.like-action.f070affe98.js.map