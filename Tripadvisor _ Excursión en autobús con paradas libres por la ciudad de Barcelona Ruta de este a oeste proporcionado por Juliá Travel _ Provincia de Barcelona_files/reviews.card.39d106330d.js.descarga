($WP="undefined"!=typeof $WP?$WP:[]).push({id:"@ta/reviews.card",d:["vendor-react-libs","@ta/common.features","@ta/overlays.popover","lithium-common","lithium-platform","vendor-babel","@ta/common.text","@ta/platform.interactions","@ta/styleguide.skeleton","@ta/iap-reporting.reviews","@ta/core-ui.card","@ta/social.overflow-menu","@ta/core-ui.avatar","@ta/reviews.context","@ta/common.client","@ta/reviews.date","@ta/core-ui.grid"],e:["./packages/reviews/card/card.jsx"],m:{"./packages/reviews/card/card.jsx":function(e,t,a){"use strict";a.r(t);var n=a("react"),r=a("@ta/common.features"),i=a("@ta/overlays.popover"),o=a.n(i),l=a("@ta/core-ui.icon"),c=a.n(l),s=a("@ta/platform.i18n"),u=a.n(s),d=function e(){return n.createElement("div",{className:"_1x8tR6PY"},n.createElement(u.a,{id:"Disclaimer_Reviews_Control_Hamon_FR"})," ",n.createElement("a",{href:"/pages/service.html"},n.createElement(u.a,{id:"hotel_info_about_service"})," "))},m=function e(){return Object(r.featureIsEnabled)("hamon_fr")?n.createElement("div",{className:"_3FJVRzYP"},n.createElement("div",{className:"_1Nt6XaXv"},n.createElement(o.a,{below:!0,closeButton:!1,contents:function e(){return n.createElement(d,null)}},function(e,t){return n.createElement("div",{ref:e,onClick:t,className:"yY1QR9JA"},n.createElement(c.a,{name:"question-circle"}))})),n.createElement(u.a,{id:"CTA_Review_Control_Hamon_FR"})):null},v=a("@ta/lithium.context"),f=a("./packages/reviews/card/utils/text.jsx"),p=function e(t){var a=t.title,r=t.originalLanguage,i=t.translationType,o=t.url,l={},c=n.useContext(v.Environment).locale.code;return i&&"MACHINE"===i&&r&&(l.lang="".concat(c,"-x-mtfrom-").concat(r)),n.createElement("div",{className:"_2cigFICy",dir:Object(f.a)(c)},n.createElement("a",{onClick:function e(t){return t.preventDefault(),!1},href:o,className:"_1xr4qUQI"},n.createElement("span",l,Object(f.c)(Object(f.b)(a||"")))))},_=a("@ta/core-ui.bubble-rating"),E=function e(t){var a=t.rating,r=t.children;return n.createElement("div",{className:"_3jYWGw8Y"},n.createElement("div",{className:"_2cyNVhH_"},a&&n.createElement(_.BubbleRating,{rating:a})),r)},w=function e(t){var a=t.children;return a?n.createElement("div",{className:"_1HMzDp0B"},a):null},g=a("@babel/runtime/helpers/esm/extends"),h=a.n(g),b=a("@ta/common.text"),N=a("@ta/platform.interactions"),x=function e(t){return n.createElement("div",{className:"_3c8yrUZX","data-automation":"reviewReadMoreCTA_".concat(t.idx)},n.createElement("span",{className:"_2zzwsgrj"},n.createElement(u.a,{id:"common_Read_more"})),n.createElement("span",{className:"_1wcYtgd8"},n.createElement(c.a,{name:"caret-down"})))},C=function e(t){return n.createElement("div",{className:"_3c8yrUZX","data-automation":"reviewReadLessCTA_".concat(t.idx)},n.createElement("span",{className:"_3_gMbOuS"},n.createElement(u.a,{id:"common_Readless"})),n.createElement("span",{className:"_1wcYtgd8"},n.createElement(c.a,{name:"caret-up"})))},R=function e(t){var a=t.text,r=t.index,i=t.expanded,o=t.expandReviews,l=t.alwaysShowReadMore,c=t.originalLanguage,s=t.translationType,u=t.children,d=t.featuredReview,m={},p=n.useContext(v.Environment).locale.code,_=Object(N.useGARecordCallback)({module:"reviews",action:"click_read_more",context:"expand"});s&&"MACHINE"===s&&c&&(m.lang="".concat(p,"-x-mtfrom-").concat(c));var E=80,w=4,g=280;return d&&(E=32,w=2,g=200),n.createElement("div",{className:"E6butUML"},n.createElement(b.ReadMore,{collapsible:!0,alwaysShowReadMore:l,cta:n.createElement(x,{idx:r}),ctaCollapse:n.createElement(C,{idx:r}),ctaNewline:!0,initialDivHeight:E,collapsed:!i,clickCallback:function e(t){return"CTA"===t||"CONTENT"===t&&!i?(o(!0),_()):"CTA_COLLAPSE"===t&&i&&o(!1),!1},numLinesToShow:w},n.createElement("q",h()({className:"".concat("_2vmgOjMl"," ").concat(!0===d?"_3cpZf64u":"")},m,{"data-automation":"reviewText_".concat(r)}),n.createElement(b.DirectionalText,{contentLanguage:p||""},i?Object(f.c)(Object(f.b)(a.trim())):Object(f.c)(Object(f.b)(function e(t){var a=t.replace(/\n/g," ");if(a.length<=280)return a;var n=a.substr(0,280);if(n=n.substr(0,Math.min(n.length,n.lastIndexOf(" "))),!t.includes("")||n.includes(""))return n;var r=a.indexOf(""),i=a.substr(r-280,280),o=Math.max(0,i.indexOf(" "));return i=i.substr(o,r-o),"...".concat(i)}(a))),!i&&a.length>g&&Object(f.c)("&hellip;")))),u)},T=R;R.defaultProps={alwaysShowReadMore:!1,featuredReview:!1};var M=a("@ta/styleguide.skeleton"),y=a.n(M),A=new Map([["BUSINESS",1],["COUPLES",2],["FAMILY",3],["FRIENDS",4],["SOLO",5]]),O=function e(t){var a=t.isLoading,r=t.tripType,i=Object(s.useLocalize)().localize;if(a)return n.createElement(y.a,{height:"10px",marginTop:"10px"});var o=A.get(r),l=o?i.string("triptype_desc_sentence_select",{0:"".concat(o)}):null;return l?n.createElement("div",{className:"_20I-kAyv"},n.createElement(s.UnsafeLocalize,{id:"trip_type_sentence",args:{0:l}})):null};O.defaultProps={tripType:null};var P=O,j=a("@ta/iap-reporting.reviews"),L=a.n(j),S=a("@ta/core-ui.card"),k=a("@ta/social.overflow-menu"),I=a.n(k),D=a("@ta/core-ui.avatar"),z=function e(t){var a,r,i,o,l,c,s,u,d,m,v,f,p,_,E,w,g,h,b,N=Object(S.useActorEventLocalize)({isVerified:(null===(a=t.reviewerProfile)||void 0===a?void 0:a.isVerified)||!1,href:(null===(r=t.reviewerProfile)||void 0===r?void 0:r.url)||"",displayName:(null===(i=t.reviewerProfile)||void 0===i?void 0:i.displayName)||"",displayDate:t.publishedDate||t.createdDate,contentCount:(null===(o=t.reviewerProfile)||void 0===o?void 0:null===(l=o.contributionCounts)||void 0===l?void 0:l.sumAllUgc)||0}).localize,x=null===(c=t.reviewerProfile)||void 0===c?void 0:null===(s=c.avatar)||void 0===s?void 0:s.photoSizes,C=x&&x.length>0?n.createElement(D.Avatar,{sources:x}):n.createElement(D.Avatar,null),R={locationId:null===(u=t.reviewerProfile)||void 0===u?void 0:null===(d=u.hometown)||void 0===d?void 0:d.locationId,fallbackString:null===(m=t.reviewerProfile)||void 0===m?void 0:null===(v=m.hometown)||void 0===v?void 0:v.fallbackString,name:null===(f=t.reviewerProfile)||void 0===f?void 0:null===(p=f.hometown)||void 0===p?void 0:null===(_=p.location)||void 0===_?void 0:null===(E=_.additionalNames)||void 0===E?void 0:E.long};return n.createElement(S.CardHeader,{overflowMenu:n.createElement(I.a,{id:"".concat(t.reviewId),useReportModal:L.a}),thumbnail:C,event:n.createElement("div",{className:"_1taODAnf"},n.createElement(S.ActorEventMessage,null,N("member_event_on_review_with_date")),n.createElement(S.MemberContribution,{helpfulVotes:(null===(w=t.reviewerProfile)||void 0===w?void 0:null===(g=w.contributionCounts)||void 0===g?void 0:g.helpfulVote)||0,hometown:R,sumAllUgc:(null===(h=t.reviewerProfile)||void 0===h?void 0:null===(b=h.contributionCounts)||void 0===b?void 0:b.sumAllUgc)||0}))})},H=a("@ta/reviews.context"),U=function e(t){var a=t||"tripadvisor.com";return a.endsWith("daodao.com")&&(a="tripadvisor.cn"),a.startsWith("www")||(a="www.".concat(a)),a},F=function e(t){var a=t.review,r=function e(t,a,n,r){var i,o=Object(s.useLocalize)().localize,l=Object(H.useGetLanguageNames)();if(i=(null==t?void 0:t.isLocalProvider)?o.string("userreviewbody_26ec"):(null==t?void 0:t.isToolsProvider)?o.string("userreview_disclaimer_lp_fffffa56"):o.string("userreview_25ed"),a&&"HUMAN"===a){var c=l.get(n||"en")||n||"en";i+=o.string("userreview_92d",{0:c,1:U(r)})}return i}(a.provider,a.translationType,a.original?a.original.language:null,a.original?a.original.submissionDomain:null),i=function o(e){return"HUMAN"===e.translationType&&e.original?n.createElement("a",{href:e.original.url},n.createElement(u.a,{id:"userreview_92e"})):null}(a);return r?n.createElement("div",{className:"_64VsXdzy"},r,i):null},X=function e(t){var a=t.review,r=Object(s.useLocalize)().localize,i=function o(e,t,a){return e?t&&t.isLocalProvider?a.string("userreviewbody_26eb"):a.string("userreviewbody_25ed"):null}(a.mgmtResponse,a.provider,r);return i?n.createElement("div",{className:"_3z-Ye34X"},i):null},Y=a("@ta/common.client"),G=a("@ta/reviews.date"),V=a.n(G),B=function e(){return n.createElement("div",{className:"N9jXywX2"},n.createElement("span",{className:"QhYTT24p"},n.createElement(u.a,{id:"common_Read_more"})),n.createElement("span",{className:"_1twRgxH3"},n.createElement(c.a,{name:"caret-down"})))},W=function e(){return n.createElement("div",{className:"N9jXywX2"},n.createElement("span",{className:"_1e9rSbGj"},n.createElement(u.a,{id:"common_Readless"})),n.createElement("span",{className:"_1twRgxH3"},n.createElement(c.a,{name:"caret-up"})))},q=function e(t){var a=t.id,r=t.username,i=t.connectionToSubject,o=t.publishedDate,l=t.locationName,c=t.text,s=t.language,d=t.expanded,m=t.children,v=t.expandReviews,p=t.isActiveOwner,_=t.translationType,E=t.alwaysShowReadMore,w=Object(Y.useIsRobotSafe)(),g=Object(j.useReportManagementResponseModal)({id:"".concat(a||-1)}).open;if(!c||"MACHINE"===_&&!w)return null;var h=d?c:c.replace(/\n/g," "),N=new Date(o),x=n.createElement("div",{className:"_1CSKaBub"},n.createElement("div",{className:"qtT-PeNE"},n.createElement("div",{className:"_1ghnCKF8"},n.createElement(D.Avatar,{size:"small",alt:""})),n.createElement("div",{className:"z33KNhCB"},r&&i&&n.createElement(u.a,{id:"hsx_management_response_header",args:{0:r,1:i,2:l}}),o&&n.createElement("div",{className:"_3UnTdVA3",title:o},n.createElement(V.a,{date:N})))),n.createElement("div",{className:"_2cFHZK_2"},m,n.createElement(b.ReadMore,{collapsible:!0,cta:B(),ctaCollapse:W(),ctaNewline:!0,alwaysShowReadMore:E||!1,collapsed:!d,initialDivHeight:20,clickCallback:function e(t){return"CTA"===t||"CONTENT"===t&&!d?v(!0):"CTA_COLLAPSE"===t&&d&&v(!1),!1},numLinesToShow:3},n.createElement("span",{className:"_2j7eJKia"},n.createElement(b.DirectionalText,{contentLanguage:s||""},Object(f.c)(Object(f.b)(h))),d&&a&&!p&&n.createElement("span",{className:"_1GTSDn0W",onClick:g},n.createElement(u.a,{id:"ric_v2_owner_resp_report_probem_with_review_ffffec52"}))))));return"MACHINE"===_?n.createElement(Y.MountedClientOnly,null,x):x},K=a("@babel/runtime/helpers/esm/slicedToArray"),Q=a.n(K),Z=a("@ta/media.image"),J=a("@ta/core-ui.grid"),$=function e(t){var a=t.reviewId,r=t.photos,i=t.onPhotoClick,o=r&&r.length-3,l=Object(N.useGARecorder)(),c=n.useContext(v.Route),s=Q()(c,2),u=s[0],d=s[1].navigateToFragment,m=u.params.detailId||0,f=n.useCallback(function(e){var t=r[e];if(t){l({module:"mediaviewer",action:"btf_userphotos",context:String(t.id),value:m});var n=null!=a?"&reviewId=".concat(a):"",i="/media/".concat(m,"/").concat(t.id,":p/?focusedIndex=").concat(e).concat(n);d(i)}},[l,r,m,a,d]);return r&&0!==r.length?n.createElement(J.Grid,{fluid:!0},n.createElement(J.Row,null,r&&r.filter(function(e){return e&&e.photoSizes&&e.photoSizes.length>0}).slice(0,3).map(function(e,t){return e.photoSizes&&n.createElement("div",{className:"RM8Rdp5X",key:t.toString(),onClick:function a(){return i?i(e.id,t):f(t)}},2===t&&o>0&&n.createElement("div",{className:"_1jk31DEp"},"+",o),n.createElement(Z.ResponsiveImage,{sources:e.photoSizes,width:"100%",height:"128px"}))}))):null};$.defaultProps={photos:[]};var ee,te=$,ae=function e(t){var a=t.reviewId,r=t.photos,i=t.onPhotoClick,o=(r||[]).filter(function(e){return!!e});return o&&o.length?n.createElement(te,{reviewId:a,photos:r,onPhotoClick:i}):null},ne=a("@ta/platform.import").component.onUsage(((ee=function e(){return a.e("@ta/reviews.card/MTProviderLogo.demand").then(a.bind(null,"./packages/reviews/card/MTProviderLogo.jsx"))}).__PACKAGE__="@ta/reviews.card",ee.__MODULE_ID__="./packages/reviews/card/MTProviderLogo.jsx",ee.__MODULE_NAME__="MTProviderLogo",ee.__BUNDLE_NAME__="@ta/reviews.card/MTProviderLogo.demand",ee.__GET_SYNC__=function(){return a.m["./packages/reviews/card/MTProviderLogo.jsx"]?a("./packages/reviews/card/MTProviderLogo.jsx"):null},ee.__IS_LOADED__=function(){return void 0!==a.m["./packages/reviews/card/MTProviderLogo.jsx"]},ee),"default"),re=function e(t){var a=t.mtProviderId,r=t.translationType;if(r&&"MACHINE"!==r)return null;var i=a||-1;return i<=0?null:n.createElement("div",{className:"_1X8ks6QQ"},n.createElement(ne,{providerId:i}))};a.d(t,"ReviewControlNotice",function(){return m}),a.d(t,"ReviewTitle",function(){return p}),a.d(t,"RatingLine",function(){return E}),a.d(t,"EventDateContainer",function(){return w}),a.d(t,"ExpandableReview",function(){return T}),a.d(t,"TripType",function(){return P}),a.d(t,"ReviewHeader",function(){return z}),a.d(t,"DisclaimerFoot",function(){return F}),a.d(t,"ResponseDisclaimerFooter",function(){return X}),a.d(t,"OwnerResponse",function(){return q}),a.d(t,"InlineReviewPhotos",function(){return ae}),a.d(t,"RateMTFooterShell",function(){return re}),a.d(t,"ReviewTextEscape",function(){return f.b}),t.default={}},"./packages/reviews/card/utils/text.jsx":function(e,t,a){"use strict";var n=a("react");a.d(t,"b",function(){return i}),a.d(t,"a",function(){return o}),a.d(t,"c",function(){return l});var r={"":'<span class="'.concat("_3kUe1Eqw",'">'),"":"</span>","\n":"<br>","&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},i=function e(t){return(t||"").replace(/[&<>"'\n\u0086\u0087]|&#?[0-9a-zA-Z]+;/g,function(e){return r[e]||e})},o=function e(t){return t&&t.match(/^(ar|iw)/i)?"rtl":"ltr"},l=function e(t,a){return n.createElement("span",{className:a,dangerouslySetInnerHTML:{__html:t}})}}}});
//# sourceMappingURL=reviews.card.39d106330d.js.map