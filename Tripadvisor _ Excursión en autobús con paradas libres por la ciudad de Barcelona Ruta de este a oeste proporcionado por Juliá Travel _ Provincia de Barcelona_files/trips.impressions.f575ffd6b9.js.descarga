($WP="undefined"!=typeof $WP?$WP:[]).push({id:"@ta/trips.impressions",d:["vendor-babel","vendor-react-libs","vendor-urql","@ta/common.features","@ta/trips.trip-types","@ta/trips.trip-util"],e:["./packages/trips/impressions/index.jsx"],m:{"./packages/trips/impressions/index.jsx":function(e,t,i){"use strict";i.r(t);var r=i("@babel/runtime/helpers/esm/defineProperty"),n=i.n(r),s=i("@babel/runtime/helpers/esm/slicedToArray"),a=i.n(s),o=i("react"),d=i("urql"),l=i("@ta/common.features"),p=JSON.parse('{"kind":"Document","definitions":[{"kind":"OperationDefinition","operation":"mutation","name":{"kind":"Name","value":"LogImpressions"},"variableDefinitions":[{"kind":"VariableDefinition","variable":{"kind":"Variable","name":{"kind":"Name","value":"impressions"}},"type":{"kind":"NonNullType","type":{"kind":"ListType","type":{"kind":"NamedType","name":{"kind":"Name","value":"ImpressionInput"}}}},"directives":[]}],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"logImpressions"},"arguments":[{"kind":"Argument","name":{"kind":"Name","value":"impressions"},"value":{"kind":"Variable","name":{"kind":"Name","value":"impressions"}}}],"directives":[]}]}}],"loc":{"start":0,"end":114}}');p.__key=0xd4238cb95b19,p.loc.source={body:"d4238cb95b19"};var u=p,c=i("@babel/runtime/helpers/esm/objectWithoutProperties"),m=i.n(c),v=Object.freeze({}),f=o.createContext(v),b=f.Provider,I=function e(t){var i=t.children,r=m()(t,["children"]);return o.createElement(b,{value:r},i)};I.defaultProps={impressionId:void 0,isImpressionLogged:!1};var k=function e(t){var i=t.source,r=t.attributes,s=t.children,p=o.useContext(f),c=o.useState(void 0),m=a()(c,2),v=m[0],b=m[1],k=o.useState(!1),T=a()(k,2),g=T[0],h=T[1],y=!(Object.keys(p).length>0)||p.isImpressionLogged,L=Object(d.useMutation)(u),P=a()(L,2)[1],S=p.impressionId||null,N=r[i],O=JSON.stringify(r),E=o.useMemo(function(){var e;return e={},n()(e,i,r[i]),n()(e,"parentId",S),e},[i,S,O]);return o.useEffect(function(){y&&(h(!1),P({impressions:[E]}).then(function(e){var t=e.data;if(t){var i=t&&t.logImpressions&&t.logImpressions[0];i&&(b(i),h(!0))}}))},[y,E,P]),Object(l.featureIsEnabled)("react_tracking_impressions")?N?o.createElement(I,{impressionId:v,isImpressionLogged:g},s):("Could not find attributes for ".concat(i),s):s},T=(i("@ta/trips.trip-types"),i("@ta/trips.trip-util")),g=function e(t){var i=t.trip,r=t.children,n=t.element,s=t.detailId,a=t.placeType,d=i.status||void 0;return o.createElement(k,{source:"tripsDetail",attributes:{tripsDetail:{tripId:i.id,status:d,relation:Object(T.userRelation)(i),collaborative:!!i.collaborators&&i.collaborators.length>0,element:n,detailId:s,placeType:a}}},r)},h={ALL_TRIPS:"ALL",PUBLIC_TRIPS:"PUBLIC",PRIVATE_TRIPS:"PRIVATE"},y=function e(t){var i=t.trips,r=t.filterSelected,n=t.children;return o.createElement(k,{source:"tripsHome",attributes:{tripsHome:{hasTrips:i&&i.length>0,filter:h[r]||"ALL"}}},n)},L=function e(t){var i=t.element,r=t.trip,n=t.trips,s=t.item,a=t.children,d=n?n.length>0:void 0,l=r&&void 0!==d?function e(t,i){return i?t?t&&t.owner&&!t.owner.isMe?"COLLABORATOR":t&&t.collaborators&&t.collaborators.length>0?"COLLABORATED":"EXISTING":"NEW":"FIRST"}(r,d):void 0;return o.createElement(k,{source:"trips",attributes:{trips:{element:i,tripId:r&&r.id,tripType:l,hasTrips:d,dated:r&&!!r.date&&(!!r.date.to||!!r.date.from||!!r.date.duration),isSaved:s&&s.saved}}},a)};i.d(t,"TrackImpression",function(){return k}),i.d(t,"TripsDetailImpression",function(){return g}),i.d(t,"TripsHomeImpression",function(){return y}),i.d(t,"TripsImpression",function(){return L}),i.d(t,"TrackingImpressionContextProvider",function(){return I}),i.d(t,"TripTrackingImpression",function(){return f})}}});
//# sourceMappingURL=trips.impressions.f575ffd6b9.js.map